<!doctype html>
<html lang="en" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PrismWeave Bookmarklet Generator</title>
    <link rel="icon" href="../assets/favicon-16x16.png" sizes="16x16" type="image/png" />
    <link rel="icon" href="../assets/favicon-32x32.png" sizes="32x32" type="image/png" />
    <link rel="icon" href="../assets/logo.svg" type="image/svg+xml" />
    <meta
      name="description"
      content="Generate a personalized PrismWeave bookmarklet with your GitHub settings embedded for universal cross-domain content capture."
    />
    <script>
      (function () {
        // minimal inline to avoid FOUC
        try {
          var storageKey = 'prismweave-theme';
          var storedTheme = localStorage.getItem(storageKey);
          var prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
          var resolvedTheme = storedTheme || (prefersDark ? 'dark' : 'light');
          document.documentElement.dataset.theme = resolvedTheme;
        } catch (error) {
          document.documentElement.dataset.theme = 'light';
        }
      })();
    </script>
    <link rel="stylesheet" href="../assets/styles.css" />
    <link rel="stylesheet" href="../assets/styles/bookmarklet-generator.css" />
  </head>
  <body class="pw-font-sans">
    <div class="page page--narrow">
      <header class="site-header">
        <div class="brand">
          <a href="../index.html" aria-label="Go to PrismWeave home" class="brand__link">
            <img src="../assets/logo.svg" alt="PrismWeave logo" class="brand__icon" />
            <div class="brand__meta">
              <h1>PrismWeave</h1>
              <p>Bookmarklet Generator</p>
            </div>
          </a>
        </div>
        <button class="pw-theme-toggle" type="button" data-theme-toggle>
          <span class="pw-theme-toggle__icon pw-theme-toggle__icon--sun" aria-hidden="true"
            >‚òÄÔ∏è</span
          >
          <span class="pw-theme-toggle__icon pw-theme-toggle__icon--moon" aria-hidden="true"
            >üåô</span
          >
          <span class="pw-theme-toggle__label">Theme</span>
        </button>
      </header>

      <main class="page-main page-main--narrow">
        <section class="pw-card pw-card--static surface generator-intro">
          <h2>Build your personal capture bookmarklet</h2>
          <p>
            Create a PrismWeave bookmarklet that embeds your GitHub preferences so you can capture
            content from any page without leaving the browser.
          </p>
        </section>

        <section class="pw-card pw-card--static surface generator-details">
          <div class="details-grid">
            <article class="pw-card details-card">
              <h3>What is this?</h3>
              <p>
                Generate a custom bookmarklet that includes your GitHub repository and workflow
                defaults. The script is optimized for speed and size while keeping the capture
                experience consistent across browsers.
              </p>
            </article>

            <article class="pw-card details-card details-card--success">
              <h4>‚ö° Optimization Highlights</h4>
              <ul>
                <li>Compact JavaScript with streamlined feedback</li>
                <li>Automatic content extraction and GitHub commits</li>
                <li>Works anywhere bookmarklets are supported</li>
              </ul>
            </article>

            <article class="pw-card details-card details-card--warning">
              <h4>üîí Security Note</h4>
              <p>
                Your GitHub token is embedded in the bookmarklet. Use a fine-grained token with
                limited repository access and keep the generated code private.
              </p>
              <ul>
                <li>Permissions: metadata (read), contents (write)</li>
                <li>Regenerate the token if it is ever exposed</li>
              </ul>
            </article>
          </div>
        </section>

        <form id="generator-form" class="pw-card pw-card--static surface generator-form">
          <h3 class="generator-form__title">Configuration</h3>
          <div class="generator-form__grid">
            <div class="generator-form-section">
              <h4>üîß GitHub Settings</h4>

              <div class="pw-form-group">
                <label for="github-token" class="pw-label">GitHub Personal Access Token *</label>
                <input
                  type="password"
                  id="github-token"
                  name="githubToken"
                  class="pw-input"
                  placeholder="ghp_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
                  required
                />
                <small>
                  Required permissions: Contents (write), Metadata (read).
                  <a
                    href="https://github.com/settings/personal-access-tokens"
                    target="_blank"
                    rel="noopener noreferrer"
                  >
                    Create token
                  </a>
                </small>
                <div class="validation-error" id="token-error"></div>
              </div>

              <div class="pw-form-group">
                <label for="github-repo" class="pw-label">GitHub Repository *</label>
                <input
                  type="text"
                  id="github-repo"
                  name="githubRepo"
                  class="pw-input"
                  placeholder="username/repository-name"
                  required
                />
                <small>Format: owner/repository (e.g., "john/my-documents")</small>
                <div class="validation-error" id="repo-error"></div>
              </div>

              <div class="pw-form-group">
                <label for="default-folder" class="pw-label">Default Folder</label>
                <select id="default-folder" name="defaultFolder" class="pw-input">
                  <option value="documents">documents</option>
                  <option value="captured">captured</option>
                  <option value="articles">articles</option>
                  <option value="research">research</option>
                  <option value="bookmarks">bookmarks</option>
                  <option value="unsorted">unsorted</option>
                </select>
                <small>Folder where captured content will be saved</small>
              </div>
            </div>

            <div class="generator-form-section">
              <h4>‚öôÔ∏è Capture Preferences</h4>

              <div class="pw-form-group">
                <label for="commit-message" class="pw-label">Commit Message Template</label>
                <input
                  type="text"
                  id="commit-message"
                  name="commitMessage"
                  class="pw-input"
                  placeholder="PrismWeave: Add captured content"
                  value="PrismWeave: Add {title}"
                />
                <small>Use {title} and {domain} as placeholders</small>
              </div>

              <div class="pw-form-group">
                <label for="file-naming" class="pw-label">File Naming Pattern</label>
                <select id="file-naming" name="fileNaming" class="pw-input">
                  <option value="date-title">YYYY-MM-DD-title-slug.md</option>
                  <option value="timestamp-title">YYYYMMDD-HHMMSS-title-slug.md</option>
                  <option value="domain-date-title">domain-YYYY-MM-DD-title-slug.md</option>
                  <option value="title-only">title-slug.md</option>
                </select>
                <small>How captured files will be named</small>
              </div>
            </div>
          </div>

          <button
            type="submit"
            class="pw-btn pw-btn-primary pw-btn-lg pw-btn-full"
            id="generate-btn"
          >
            üöÄ Generate My Personal Bookmarklet
          </button>
        </form>

        <div id="status-message" class="generator-status"></div>

        <section class="pw-card pw-card--static surface generator-result" id="result-section">
          <h3>‚úÖ Your Personal Bookmarklet is Ready!</h3>

          <div class="bookmarklet-preview">
            <h4>Drag this to your bookmarks bar:</h4>
            <div class="generator-actions">
              <a href="javascript:void(0)" class="pw-btn pw-btn-primary" id="bookmarklet-link">
                <img src="../assets/logo.svg" alt="" class="bookmarklet-icon" />
                PrismWeave Capture
              </a>
            </div>
          </div>

          <div class="generator-install">
            <h4 class="pw-mb-2">üìã Installation Instructions</h4>
            <ol>
              <li>
                <strong>Install:</strong>
                Drag the "PrismWeave Capture" button to your bookmarks bar.
              </li>
              <li>
                <strong>Use:</strong>
                Visit any webpage and tap your new bookmark to capture content.
              </li>
            </ol>
          </div>

          <div class="bookmarklet-code">
            <div id="bookmarklet-code-display"></div>
          </div>
        </section>
      </main>

      <footer class="site-footer site-footer--compact">
        <small>Bookmarklets run locally in your browser &mdash; PrismWeave v{{VERSION}}</small>
        <a href="../index.html" aria-label="Go to PrismWeave home" class="site-footer__home-link">
          <img src="../assets/logo.svg" alt="PrismWeave emblem" class="site-footer__icon" />
        </a>
      </footer>
    </div>

    <script src="../assets/theme.js"></script>
    <script src="generator.js"></script>
  </body>
</html>
