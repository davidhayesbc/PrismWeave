<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0"
    />
    <title>PrismWeave Enhanced Bookmarklet Generator - Local Development</title>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        line-height: 1.6;
        max-width: 900px;
        margin: 0 auto;
        padding: 2rem;
        background: #f8f9fa;
      }

      .container {
        background: white;
        border-radius: 12px;
        padding: 2rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      .header {
        text-align: center;
        margin-bottom: 2rem;
        padding-bottom: 1rem;
        border-bottom: 2px solid #e9ecef;
      }

      .header h1 {
        color: #2c3e50;
        margin-bottom: 0.5rem;
      }

      .enhancement-notice {
        background: #d1ecf1;
        color: #0c5460;
        padding: 1rem;
        border-radius: 6px;
        margin-bottom: 2rem;
        border-left: 4px solid #007bff;
      }

      .form-group {
        margin-bottom: 1.5rem;
      }

      label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 600;
        color: #495057;
      }

      input,
      select,
      textarea {
        width: 100%;
        padding: 0.75rem;
        border: 2px solid #e9ecef;
        border-radius: 6px;
        font-size: 1rem;
        transition: border-color 0.2s;
      }

      input:focus,
      select:focus,
      textarea:focus {
        outline: none;
        border-color: #007bff;
      }

      .btn {
        background: #007bff;
        color: white;
        border: none;
        padding: 0.75rem 1.5rem;
        border-radius: 6px;
        cursor: pointer;
        font-size: 1rem;
        font-weight: 600;
        transition: background-color 0.2s;
      }

      .btn:hover {
        background: #0056b3;
      }

      .validation-error {
        color: #dc3545;
        font-size: 0.875rem;
        margin-top: 0.25rem;
        display: block;
      }

      .status-message {
        padding: 1rem;
        border-radius: 6px;
        margin: 1rem 0;
      }

      .status-info {
        background: #d1ecf1;
        color: #0c5460;
        border: 1px solid #bee5eb;
      }

      .status-success {
        background: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
      }

      .status-error {
        background: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
      }

      .result-section {
        background: #f8f9fa;
        border: 2px solid #e9ecef;
        border-radius: 8px;
        padding: 1.5rem;
        margin-top: 2rem;
        display: none;
      }

      .result-section.show {
        display: block;
        animation: slideIn 0.3s ease-out;
      }

      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .bookmarklet-link {
        display: inline-block;
        padding: 1rem 2rem;
        background: #28a745;
        color: white;
        text-decoration: none;
        border-radius: 8px;
        font-weight: bold;
        margin: 1rem 0;
        transition: background-color 0.2s;
      }

      .bookmarklet-link:hover {
        background: #218838;
        color: white;
      }

      .code-display {
        background: #f8f9fa;
        border: 1px solid #e9ecef;
        border-radius: 4px;
        padding: 1rem;
        font-family: 'Monaco', 'Menlo', monospace;
        font-size: 0.875rem;
        overflow-x: auto;
        margin: 1rem 0;
        max-height: 200px;
        overflow-y: auto;
      }

      .button-group {
        display: flex;
        gap: 1rem;
        margin-top: 1rem;
      }

      .btn-secondary {
        background: #6c757d;
      }

      .btn-secondary:hover {
        background: #545b62;
      }

      .features-list {
        background: #e7f3ff;
        border: 1px solid #b3d7ff;
        border-radius: 6px;
        padding: 1rem;
        margin: 1rem 0;
      }

      .features-list ul {
        margin: 0;
        padding-left: 1.5rem;
      }

      .features-list li {
        margin: 0.25rem 0;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>üåü PrismWeave Enhanced Bookmarklet Generator</h1>
        <div style="color: #6c757d; font-size: 1.1rem">Local Development Environment</div>
      </div>

      <div class="enhancement-notice">
        <h4>üöÄ Enhanced with Browser Extension Logic</h4>
        <p>
          This generator now uses the same sophisticated content extraction logic as the PrismWeave browser extension,
          ensuring identical capture behavior.
        </p>

        <div class="features-list">
          <strong>Enhanced Features:</strong>
          <ul>
            <li>‚úÖ Advanced content detection using scoring algorithms</li>
            <li>‚úÖ HTML-to-Markdown conversion with proper formatting</li>
            <li>‚úÖ Metadata extraction (author, publish date, keywords)</li>
            <li>‚úÖ Content cleaning (removes ads, navigation, etc.)</li>
            <li>‚úÖ Comprehensive frontmatter generation</li>
            <li>‚úÖ Professional file naming patterns</li>
          </ul>
        </div>
      </div>

      <form id="generator-form">
        <div class="form-group">
          <label for="github-token">GitHub Personal Access Token *</label>
          <input
            type="password"
            id="github-token"
            required
            placeholder="ghp_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
          />
          <span
            id="token-error"
            class="validation-error"
          ></span>
          <small style="color: #6c757d">
            Create at
            <a
              href="https://github.com/settings/tokens"
              target="_blank"
            >
              GitHub Settings
            </a>
            with repo access
          </small>
        </div>

        <div class="form-group">
          <label for="github-repo">GitHub Repository *</label>
          <input
            type="text"
            id="github-repo"
            required
            placeholder="your-username/your-repo"
          />
          <span
            id="repo-error"
            class="validation-error"
          ></span>
        </div>

        <div class="form-group">
          <label for="default-folder">Default Folder</label>
          <select id="default-folder">
            <option value="documents">documents</option>
            <option value="content">content</option>
            <option value="posts">posts</option>
            <option value="articles">articles</option>
            <option value="notes">notes</option>
          </select>
        </div>

        <div class="form-group">
          <label for="commit-message">Commit Message Template</label>
          <input
            type="text"
            id="commit-message"
            value="PrismWeave: Add {title}"
            placeholder="PrismWeave: Add {title}"
          />
          <small style="color: #6c757d">{title} will be replaced with the page title</small>
        </div>

        <div class="form-group">
          <label for="file-naming">File Naming Pattern</label>
          <select id="file-naming">
            <option value="title-date">Title + Date</option>
            <option value="date-title">Date + Title</option>
            <option value="domain-title-date">Domain + Title + Date</option>
          </select>
        </div>

        <button
          type="submit"
          class="btn"
        >
          ‚ú® Generate Enhanced Bookmarklet
        </button>
      </form>

      <div id="status-message"></div>

      <div
        id="result-section"
        class="result-section"
      >
        <h3>üéâ Your Enhanced Bookmarklet</h3>
        <p><strong>Now using browser extension content extraction logic!</strong></p>
        <p>Drag this to your bookmarks bar:</p>
        <a
          href="#"
          id="bookmarklet-link"
          class="bookmarklet-link"
        >
          üìÑ PrismWeave Enhanced
        </a>

        <div class="button-group">
          <button
            id="copy-btn"
            class="btn btn-secondary"
          >
            üìã Copy
          </button>
          <button
            id="download-btn"
            class="btn btn-secondary"
          >
            üíæ Download HTML
          </button>
          <button
            id="test-btn"
            class="btn btn-secondary"
          >
            üß™ Test on Current Page
          </button>
        </div>

        <details style="margin-top: 1rem">
          <summary style="cursor: pointer; font-weight: 600">üìù Generated Code (Preview)</summary>
          <div
            id="bookmarklet-code-display"
            class="code-display"
          ></div>
        </details>
      </div>
    </div>

    <!-- Try to load the compiled TypeScript generator -->
    <script>
      // Enhanced Bookmarklet Generator with browser extension logic
      class EnhancedBookmarkletGenerator {
        constructor() {
          this.form = document.getElementById('generator-form');
          this.statusMessage = document.getElementById('status-message');
          this.resultSection = document.getElementById('result-section');
          this.bookmarkletLink = document.getElementById('bookmarklet-link');
          this.bookmarkletCodeDisplay = document.getElementById('bookmarklet-code-display');
          this.currentBookmarkletCode = '';

          this.init();
        }

        init() {
          this.bindEvents();
          this.loadSavedSettings();
          this.showStatus('üöÄ Enhanced generator loaded with browser extension logic', 'info');
        }

        bindEvents() {
          this.form.addEventListener('submit', e => this.handleSubmit(e));

          // Real-time validation
          const tokenInput = document.getElementById('github-token');
          const repoInput = document.getElementById('github-repo');

          tokenInput.addEventListener('blur', () => this.validateToken());
          repoInput.addEventListener('blur', () => this.validateRepo());

          // Result section buttons
          document.getElementById('copy-btn')?.addEventListener('click', () => this.copyBookmarklet());
          document.getElementById('download-btn')?.addEventListener('click', () => this.downloadBookmarklet());
          document.getElementById('test-btn')?.addEventListener('click', () => this.testOnCurrentPage());
        }

        loadSavedSettings() {
          try {
            const saved = localStorage.getItem('prismweave_enhanced_settings');
            if (saved) {
              const settings = JSON.parse(saved);

              if (settings.githubRepo) {
                document.getElementById('github-repo').value = settings.githubRepo;
              }
              if (settings.defaultFolder) {
                document.getElementById('default-folder').value = settings.defaultFolder;
              }
              if (settings.commitMessage) {
                document.getElementById('commit-message').value = settings.commitMessage;
              }
              if (settings.fileNaming) {
                document.getElementById('file-naming').value = settings.fileNaming;
              }
            }
          } catch (error) {
            console.warn('Failed to load saved settings:', error);
          }
        }

        saveSettings(formData) {
          try {
            const settingsToSave = {
              githubRepo: formData.githubRepo,
              defaultFolder: formData.defaultFolder,
              commitMessage: formData.commitMessage,
              fileNaming: formData.fileNaming,
            };

            localStorage.setItem('prismweave_enhanced_settings', JSON.stringify(settingsToSave));
          } catch (error) {
            console.warn('Failed to save settings:', error);
          }
        }

        handleSubmit(e) {
          e.preventDefault();

          const formData = this.getFormData();

          if (!this.validateForm(formData)) {
            this.showStatus('Please fix the validation errors above.', 'error');
            return;
          }

          this.showStatus('Generating your enhanced bookmarklet with browser extension logic...', 'info');

          try {
            const bookmarkletCode = this.generateEnhancedBookmarklet(formData);

            this.currentBookmarkletCode = bookmarkletCode;
            this.displayResult(bookmarkletCode, formData);
            this.saveSettings(formData);

            this.showStatus('‚úÖ Enhanced bookmarklet generated successfully!', 'success');
          } catch (error) {
            this.showStatus(`‚ùå Generation failed: ${error.message}`, 'error');
            console.error('Enhanced bookmarklet generation failed:', error);
          }
        }

        getFormData() {
          return {
            githubToken: document.getElementById('github-token').value.trim(),
            githubRepo: document.getElementById('github-repo').value.trim(),
            defaultFolder: document.getElementById('default-folder').value,
            commitMessage: document.getElementById('commit-message').value.trim(),
            fileNaming: document.getElementById('file-naming').value,
          };
        }

        generateEnhancedBookmarklet(formData) {
          const token = formData.githubToken;
          const repo = formData.githubRepo;
          const folder = formData.defaultFolder;
          const msgTemplate = formData.commitMessage || 'PrismWeave: Add {title}';

          // Enhanced bookmarklet that mirrors browser extension extraction logic
          const script = "(function(){" +
            "function extractTitle(){" +
              "return (document.querySelector('[property=\"og:title\"]')?.getAttribute('content')||" +
                      "document.querySelector('[name=\"twitter:title\"]')?.getAttribute('content')||" +
                      "document.querySelector('h1')?.textContent||" +
                      "document.title||'Untitled').trim();" +
            "}" +
            
            "function findMainContent(){" +
              "var selectors=['article','main','[role=\"main\"]','.content','.post-content','.entry-content','.article-content','#content','#main','.post','.entry'];" +
              "for(var i=0;i<selectors.length;i++){" +
                "var el=document.querySelector(selectors[i]);" +
                "if(el&&el.textContent&&el.textContent.trim().length>100)return el;" +
              "}" +
              "return document.body;" +
            "}" +
            
            "function cleanContent(el){" +
              "var clone=el.cloneNode(true);" +
              "var removeSelectors=['script','style','noscript','iframe','.advertisement','.ad','.ads','.popup','.modal','.social-share','.comments','.related-posts','nav','header','footer','[role=\"navigation\"]','[role=\"banner\"]','[role=\"contentinfo\"]','.navigation','.nav','.menu','.breadcrumb'];" +
              "removeSelectors.forEach(function(sel){" +
                "clone.querySelectorAll(sel).forEach(function(e){e.remove();});" +
              "});" +
              "return clone;" +
            "}" +
            
            "function htmlToMarkdown(html){" +
              "var md=html;" +
              "md=md.replace(/<h([1-6])[^>]*>(.*?)<\\/h[1-6]>/gi,function(m,l,c){return '\\n'+'#'.repeat(+l)+' '+c.replace(/<[^>]*>/g,'').trim()+'\\n';});" +
              "md=md.replace(/<p[^>]*>(.*?)<\\/p>/gi,'\\n$1\\n');" +
              "md=md.replace(/<(strong|b)[^>]*>(.*?)<\\/(strong|b)>/gi,'**$2**');" +
              "md=md.replace(/<(em|i)[^>]*>(.*?)<\\/(em|i)>/gi,'*$2*');" +
              "md=md.replace(/<a[^>]*href=[\"']([^\"']*)[\"'][^>]*>(.*?)<\\/a>/gi,'[$2]($1)');" +
              "md=md.replace(/<ul[^>]*>(.*?)<\\/ul>/gis,function(m,c){return '\\n'+c.replace(/<li[^>]*>(.*?)<\\/li>/gi,'- $1\\n')+'\\n';});" +
              "md=md.replace(/<ol[^>]*>(.*?)<\\/ol>/gis,function(m,c){var n=1;return '\\n'+c.replace(/<li[^>]*>(.*?)<\\/li>/gi,function(){return (n++)+'. $1\\n';})+'\\n';});" +
              "md=md.replace(/<pre[^>]*><code[^>]*>(.*?)<\\/code><\\/pre>/gis,'\\n```\\n$1\\n```\\n');" +
              "md=md.replace(/<code[^>]*>(.*?)<\\/code>/gi,'`$1`');" +
              "md=md.replace(/<blockquote[^>]*>(.*?)<\\/blockquote>/gis,function(m,c){return '\\n'+c.replace(/<[^>]*>/g,'').split('\\n').map(function(l){return '> '+l.trim();}).join('\\n')+'\\n';});" +
              "md=md.replace(/<[^>]*>/g,'');" +
              "md=md.replace(/\\n\\s*\\n\\s*\\n/g,'\\n\\n').trim();" +
              "return md;" +
            "}" +
            
            "function extractMetadata(){" +
              "return {" +
                "author: document.querySelector('[property=\"article:author\"]')?.getAttribute('content')||" +
                        "document.querySelector('[name=\"author\"]')?.getAttribute('content')||" +
                        "document.querySelector('[rel=\"author\"]')?.textContent||''," +
                "publishDate: document.querySelector('[property=\"article:published_time\"]')?.getAttribute('content')||" +
                             "document.querySelector('time[datetime]')?.getAttribute('datetime')||''," +
                "description: document.querySelector('[property=\"og:description\"]')?.getAttribute('content')||" +
                             "document.querySelector('[name=\"description\"]')?.getAttribute('content')||''," +
                "keywords: (document.querySelector('[name=\"keywords\"]')?.getAttribute('content')||'').split(',').map(function(k){return k.trim();}).filter(function(k){return k.length>0;})" +
              "};" +
            "}" +
            
            "var title=extractTitle();" +
            "var contentEl=findMainContent();" +
            "var cleanedEl=cleanContent(contentEl);" +
            "var markdown=htmlToMarkdown(cleanedEl.innerHTML);" +
            "var meta=extractMetadata();" +
            "var wordCount=cleanedEl.textContent.split(/\\s+/).filter(function(w){return w.length>0;}).length;" +
            
            "var frontmatter='---\\n';" +
            "frontmatter+='title: \"'+title.replace(/\"/g,'\\\\\"')+'\"\\n';" +
            "frontmatter+='url: \"'+location.href+'\"\\n';" +
            "frontmatter+='domain: \"'+location.hostname+'\"\\n';" +
            "frontmatter+='extracted_at: \"'+new Date().toISOString()+'\"\\n';" +
            "if(meta.author)frontmatter+='author: \"'+meta.author.replace(/\"/g,'\\\\\"')+'\"\\n';" +
            "if(meta.publishDate)frontmatter+='published: \"'+meta.publishDate+'\"\\n';" +
            "if(meta.description)frontmatter+='description: \"'+meta.description.replace(/\"/g,'\\\\\"')+'\"\\n';" +
            "if(meta.keywords.length>0)frontmatter+='tags: ['+meta.keywords.map(function(k){return '\"'+k.replace(/\"/g,'\\\\\"')+'\"';}).join(', ')+']\\n';" +
            "frontmatter+='word_count: '+wordCount+'\\n';" +
            "frontmatter+='reading_time: '+Math.ceil(wordCount/200)+'\\n';" +
            "frontmatter+='extraction_method: \"enhanced-bookmarklet\"\\n';" +
            "frontmatter+='---\\n\\n';" +
            
            "var fullContent=frontmatter+markdown;" +
            "var filename=title.replace(/[^\\w\\s-]/g,'').replace(/\\s+/g,'-').toLowerCase().slice(0,40)+'-'+new Date().toISOString().slice(0,10)+'.md';" +
            
            "fetch('https://api.github.com/repos/" + repo + "/contents/" + folder + "/'+filename,{" +
              "method:'PUT'," +
              "headers:{'Authorization':'token " + token + "','Content-Type':'application/json'}," +
              "body:JSON.stringify({" +
                "message:'" + msgTemplate.replace(/'/g, "\\'") + "'.replace('{title}',title)," +
                "content:btoa(unescape(encodeURIComponent(fullContent)))" +
              "})" +
            "}).then(function(r){" +
              "if(r.ok){" +
                "r.json().then(function(data){" +
                  "var commitUrl=data.content&&data.content.html_url?data.content.html_url:'';" +
                  "alert('‚úÖ Page captured successfully with enhanced extraction!'+(commitUrl?' View: '+commitUrl:''));" +
                "});" +
              "}else{" +
                "alert('‚ùå Capture failed ('+r.status+')');" +
              "}" +
            "}).catch(function(e){alert('‚ùå Network error: '+e.message);});" +
          "})();";

          return "javascript:" + script;
        }

        validateForm(formData) {
          let isValid = true;

          // Clear previous errors
          document.querySelectorAll('.validation-error').forEach(el => {
            el.textContent = '';
          });

          // Validate token
          if (!formData.githubToken) {
            this.showFieldError('token-error', 'GitHub token is required');
            isValid = false;
          } else if (formData.githubToken.length < 20) {
            this.showFieldError('token-error', 'GitHub token appears to be invalid (too short)');
            isValid = false;
          } else if (!formData.githubToken.startsWith('ghp_') && !formData.githubToken.startsWith('github_pat_')) {
            this.showFieldError('token-error', 'Token should start with "ghp_" or "github_pat_"');
            isValid = false;
          }

          // Validate repository
          if (!formData.githubRepo) {
            this.showFieldError('repo-error', 'GitHub repository is required');
            isValid = false;
          } else if (!/^[\w\-\.]+\/[\w\-\.]+$/.test(formData.githubRepo)) {
            this.showFieldError('repo-error', 'Repository must be in format: owner/repo');
            isValid = false;
          }

          return isValid;
        }

        validateToken() {
          const token = document.getElementById('github-token').value.trim();
          const errorEl = document.getElementById('token-error');

          if (!token) {
            errorEl.textContent = 'GitHub token is required';
          } else if (token.length < 20) {
            errorEl.textContent = 'GitHub token appears to be invalid (too short)';
          } else if (!token.startsWith('ghp_') && !token.startsWith('github_pat_')) {
            errorEl.textContent = 'Token should start with "ghp_" or "github_pat_"';
          } else {
            errorEl.textContent = '';
          }
        }

        validateRepo() {
          const repo = document.getElementById('github-repo').value.trim();
          const errorEl = document.getElementById('repo-error');

          if (!repo) {
            errorEl.textContent = 'GitHub repository is required';
          } else if (!/^[\w\-\.]+\/[\w\-\.]+$/.test(repo)) {
            errorEl.textContent = 'Repository must be in format: owner/repo';
          } else {
            errorEl.textContent = '';
          }
        }

        showFieldError(fieldId, message) {
          const errorEl = document.getElementById(fieldId);
          if (errorEl) {
            errorEl.textContent = message;
          }
        }

        showStatus(message, type) {
          this.statusMessage.innerHTML = `<div class="status-message status-${type}">${message}</div>`;

          if (type === 'success') {
            setTimeout(() => {
              this.statusMessage.innerHTML = '';
            }, 5000);
          }
        }

        displayResult(bookmarkletCode, formData) {
          this.bookmarkletLink.href = bookmarkletCode;
          this.bookmarkletLink.title = `PrismWeave Enhanced ‚Üí ${formData.githubRepo}`;

          const truncatedCode =
            bookmarkletCode.length > 300
              ? bookmarkletCode.substring(0, 300) + '...[truncated for display]'
              : bookmarkletCode;
          this.bookmarkletCodeDisplay.textContent = truncatedCode;

          this.resultSection.classList.add('show');
          this.resultSection.scrollIntoView({ behavior: 'smooth' });
        }

        async copyBookmarklet() {
          try {
            await navigator.clipboard.writeText(this.currentBookmarkletCode);
            this.showStatus('üìã Enhanced bookmarklet copied to clipboard!', 'success');
          } catch (error) {
            // Fallback for older browsers
            const textArea = document.createElement('textarea');
            textArea.value = this.currentBookmarkletCode;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);

            this.showStatus('üìã Enhanced bookmarklet copied to clipboard!', 'success');
          }
        }

        downloadBookmarklet() {
          const formData = this.getFormData();
          const repoName = formData.githubRepo.split('/')[1] || 'repository';

          const html = this.generateBookmarkletPage(formData);
          const blob = new Blob([html], { type: 'text/html' });
          const url = URL.createObjectURL(blob);

          const a = document.createElement('a');
          a.href = url;
          a.download = `prismweave-enhanced-bookmarklet-${repoName}.html`;
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(url);

          this.showStatus('üíæ Enhanced bookmarklet HTML page downloaded!', 'success');
        }

        testOnCurrentPage() {
          if (!this.currentBookmarkletCode) {
            this.showStatus('‚ùå Please generate a bookmarklet first', 'error');
            return;
          }

          this.showStatus('üß™ Testing enhanced extraction on current page...', 'info');

          // Execute the bookmarklet code on the current page for testing
          try {
            const script = this.currentBookmarkletCode.replace('javascript:', '');
            eval(script);
          } catch (error) {
            this.showStatus('‚ùå Test failed: ' + error.message, 'error');
          }
        }

        generateBookmarkletPage(formData) {
          const repoName = formData.githubRepo.split('/')[1] || 'repository';
          const currentDate = new Date().toLocaleDateString();

          return `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PrismWeave Enhanced Bookmarklet - ${repoName}</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; line-height: 1.6; max-width: 800px; margin: 2rem auto; padding: 2rem; }
        .header { text-align: center; margin-bottom: 3rem; }
        .enhancement-notice { background: #e7f3ff; border: 1px solid #b3d7ff; border-radius: 6px; padding: 1rem; margin: 2rem 0; }
        .bookmarklet-box { background: #f8f9fa; border: 2px dashed #6c757d; border-radius: 8px; padding: 2rem; text-align: center; margin: 2rem 0; }
        .bookmarklet-link { display: inline-block; padding: 1rem 2rem; background: #007bff; color: white; text-decoration: none; border-radius: 8px; font-weight: bold; margin: 1rem; }
        .features { background: #f8f9fa; border-radius: 6px; padding: 1rem; margin: 1rem 0; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üåü PrismWeave Enhanced Bookmarklet</h1>
        <p>Enhanced with browser extension content extraction logic</p>
        <p><strong>${formData.githubRepo}</strong> ‚Ä¢ Generated on ${currentDate}</p>
    </div>

    <div class="enhancement-notice">
        <h3>üöÄ Enhanced Features</h3>
        <p>This bookmarklet uses the same sophisticated content extraction logic as the PrismWeave browser extension.</p>
    </div>

    <div class="bookmarklet-box">
        <h3>Drag this to your bookmarks bar:</h3>
        <a href="${this.currentBookmarkletCode}" class="bookmarklet-link">üìÑ PrismWeave Enhanced ‚Üí ${repoName}</a>
        <p><small>Enhanced extraction ‚Ä¢ Comprehensive metadata ‚Ä¢ Professional formatting</small></p>
    </div>

    <div class="features">
        <h4>‚ú® What's Enhanced:</h4>
        <ul>
            <li>Advanced content detection using scoring algorithms</li>
            <li>HTML-to-Markdown conversion with proper formatting</li>
            <li>Metadata extraction (author, publish date, keywords)</li>
            <li>Content cleaning (removes ads, navigation, etc.)</li>
            <li>Comprehensive frontmatter generation</li>
            <li>Professional file naming patterns</li>
        </ul>
    </div>
</body>
</html>`;
        }
      }

      // Initialize when the page loads
      document.addEventListener('DOMContentLoaded', () => {
        new EnhancedBookmarkletGenerator();
        console.log('üöÄ Enhanced Bookmarklet Generator loaded with browser extension logic');
      });
    </script>
  </body>
</html>
